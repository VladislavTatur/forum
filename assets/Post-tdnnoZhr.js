import{k as B,j as e,r as y,m as lo,n as co,p as po,z as F,t as go,q,H as p,v as mo,A as ho,I as uo,a4 as fo,a5 as O,Y as E,g as N,u as _,a6 as vo,B as T,T as j,b as xo,a7 as bo,a8 as Co,W as x,J as P,a9 as yo,aa as Oo,ab as Po,ac as jo,a as Bo,a3 as Ro,R as zo}from"./index-rbl_s6k7.js";import{T as To}from"./TextField-Ck7Yxwsa.js";const ko=B(e.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"})),So=B(e.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H6l-2 2V4h16z"})),$o=B(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"})),Io=B(e.jsx("path",{d:"m10.89 18.28.57-2.89c.12-.59-.04-1.2-.42-1.66S10.1 13 9.5 13H4v-1.08L6.57 6h8.09c.18 0 .34.16.34.34v7.84zM10 22l6.41-6.41c.38-.38.59-.89.59-1.42V6.34C17 5.05 15.95 4 14.66 4h-8.1c-.71 0-1.36.37-1.72.97l-2.67 6.15c-.11.25-.17.52-.17.8V13c0 1.1.9 2 2 2h5.5l-.92 4.65c-.05.22-.02.46.08.66.23.45.52.86.88 1.22zm10-7h2V4h-2c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1"})),Mo=B(e.jsx("path",{d:"m13.11 5.72-.57 2.89c-.12.59.04 1.2.42 1.66s.94.73 1.54.73H20v1.08L17.43 18H9.34c-.18 0-.34-.16-.34-.34V9.82zM14 2 7.59 8.41C7.21 8.79 7 9.3 7 9.83v7.83C7 18.95 8.05 20 9.34 20h8.1c.71 0 1.36-.37 1.72-.97l2.67-6.15c.11-.25.17-.52.17-.8V11c0-1.1-.9-2-2-2h-5.5l.92-4.65c.05-.22.02-.46-.08-.66-.23-.45-.52-.86-.88-1.22zM4 9H2v11h2c.55 0 1-.45 1-1v-9c0-.55-.45-1-1-1"})),w=t=>{const o=y.useRef({});return y.useEffect(()=>{o.current=t}),o.current};function Ao(t){const{badgeContent:o,invisible:s=!1,max:n=99,showZero:a=!1}=t,i=w({badgeContent:o,max:n});let l=s;s===!1&&o===0&&!a&&(l=!0);const{badgeContent:r,max:g=n}=l?i:t,m=r&&Number(r)>g?`${g}+`:r;return{badgeContent:r,invisible:l,max:g,displayValue:m}}function Vo(t){return co("MuiBadge",t)}const u=lo("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),$=10,I=4,Do=t=>{const{color:o,anchorOrigin:s,invisible:n,overlap:a,variant:i,classes:l={}}=t,r={root:["root"],badge:["badge",i,n&&"invisible",`anchorOrigin${p(s.vertical)}${p(s.horizontal)}`,`anchorOrigin${p(s.vertical)}${p(s.horizontal)}${p(a)}`,`overlap${p(a)}`,o!=="default"&&`color${p(o)}`]};return mo(r,Vo,l)},Lo=q("span",{name:"MuiBadge",slot:"Root"})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Ho=q("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.badge,o[s.variant],o[`anchorOrigin${p(s.anchorOrigin.vertical)}${p(s.anchorOrigin.horizontal)}${p(s.overlap)}`],s.color!=="default"&&o[`color${p(s.color)}`],s.invisible&&o.invisible]}})(ho(({theme:t})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:$*2,lineHeight:1,padding:"0 6px",height:$*2,borderRadius:$,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.entries(t.palette).filter(uo(["contrastText"])).map(([o])=>({props:{color:o},style:{backgroundColor:(t.vars||t).palette[o].main,color:(t.vars||t).palette[o].contrastText}})),{props:{variant:"dot"},style:{borderRadius:I,height:I*2,minWidth:I*2,padding:0}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${u.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${u.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${u.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${u.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${u.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="right"&&o.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${u.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="top"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${u.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:o})=>o.anchorOrigin.vertical==="bottom"&&o.anchorOrigin.horizontal==="left"&&o.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${u.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]})));function W(t){return{vertical:t?.vertical??"top",horizontal:t?.horizontal??"right"}}const Fo=y.forwardRef(function(o,s){const n=po({props:o,name:"MuiBadge"}),{anchorOrigin:a,className:i,classes:l,component:r,components:g={},componentsProps:m={},children:f,overlap:h="rectangular",color:b="default",invisible:v=!1,max:d=99,badgeContent:R,slots:C,slotProps:z,showZero:c=!1,variant:k="standard",...G}=n,{badgeContent:M,invisible:Z,max:J,displayValue:K}=Ao({max:d,invisible:v,badgeContent:R,showZero:c}),X=w({anchorOrigin:W(a),color:b,overlap:h,variant:k,badgeContent:R}),A=Z||M==null&&k!=="dot",{color:oo=b,overlap:to=h,anchorOrigin:eo,variant:V=k}=A?X:n,so=W(eo),D=V!=="dot"?K:void 0,S={...n,badgeContent:M,invisible:A,max:J,displayValue:D,showZero:c,anchorOrigin:so,color:oo,overlap:to,variant:V},L=Do(S),H={slots:{root:C?.root??g.Root,badge:C?.badge??g.Badge},slotProps:{root:z?.root??m.root,badge:z?.badge??m.badge}},[ro,no]=F("root",{elementType:Lo,externalForwardedProps:{...H,...G},ownerState:S,className:go(L.root,i),ref:s,additionalProps:{as:r}}),[ao,io]=F("badge",{elementType:Ho,externalForwardedProps:H,ownerState:S,className:L.badge});return e.jsxs(ro,{...no,children:[f,e.jsx(ao,{...io,children:D})]})}),Wo=fo.injectEndpoints({endpoints:t=>({getPosts:t.query({query:()=>"posts"}),getPostById:t.query({query:o=>`posts/${o}`}),getPostComments:t.query({query:o=>`posts/${o}/comments`}),createPost:t.mutation({query:o=>({url:"posts",method:"POST",body:o})}),searchForUserPosts:t.query({query:o=>`posts/?userId=${o}`})})}),{useGetPostsQuery:Go,useLazyGetPostByIdQuery:Zo,useGetPostCommentsQuery:Q,useCreatePostMutation:Jo,useSearchForUserPostsQuery:Ko}=Wo,Y=()=>O(t=>t.comments.localComments),Uo=()=>O(t=>t.comments.serverCommentsCount),qo=()=>O(t=>t.postsSlice),Xo=()=>O(t=>t.postsSlice.localPosts),ot=()=>O(t=>t.postsSlice.serverPosts),tt=()=>O(t=>t.postsSlice.reactions),Eo=({body:t,email:o})=>e.jsxs("div",{style:{marginBottom:10,backgroundColor:"white",borderRadius:"5px",padding:"5px 20px"},children:[e.jsx("p",{style:{fontWeight:600},children:o}),e.jsx("p",{style:{fontSize:14,paddingLeft:15},children:t})]}),No=({isOpen:t,setIsOpen:o,postId:s})=>{const n=E(),[a,i]=y.useState(""),l=N(),{data:r}=Q(s),g=_(),f=Y().filter(d=>d.postId===s),h=r?[...f,...r]:[],b=()=>o(!1),v=()=>{n&&(l&&g(bo({postId:s,id:new Date().getTime(),name:l.name,email:l.email,body:a})),i(""))};return e.jsx(vo,{open:t,onClose:b,children:e.jsxs(T,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,maxHeight:"80vh",bgcolor:"background.paper",borderRadius:2,boxShadow:24,display:"flex",flexDirection:"column"},children:[e.jsx(T,{sx:{p:2,borderBottom:"1px solid #ddd"},children:e.jsx(j,{variant:"h6",children:"Comments"})}),e.jsx(T,{sx:{flex:1,overflowY:"auto",p:2,display:"flex",flexDirection:"column",gap:1},children:h.length>0?h.map(d=>e.jsx(Eo,{body:d.body,email:d.email},d.id)):e.jsx(j,{color:"text.secondary",children:"No comments yet"})}),e.jsxs(T,{sx:{p:2,borderTop:"1px solid #ddd",display:"flex",gap:1},children:[e.jsx(To,{fullWidth:!0,multiline:!0,minRows:1,placeholder:n?"Write a comment...":"You must be logged in to comment",value:a,onChange:d=>i(d.target.value),disabled:!n}),e.jsx(xo,{variant:"contained",onClick:v,disabled:!n||!a.trim(),children:"Send"})]})]})})},_o={favorite:jo,like:Po,dislike:Oo},wo=({postId:t,userId:o})=>{const s=_(),n=qo(),a=Y(),i=Uo(),l=N(),r=E(),[g,m]=y.useState(!1),{data:f}=Q(t),h=l?.id===o,b=i.filter(c=>c.postId===t),v=n.reactions.find(c=>c.idPost===t),d=a.filter(c=>c.postId===t).length??0,R=(b[0]?.count??0)+d,C=c=>{r&&s(_o[c](t))},z=()=>{h&&s(yo(t))};return y.useEffect(()=>{f&&s(Co({postId:t,count:f.length}))},[s,f,t]),e.jsxs(x,{direction:"row",spacing:1,children:[h&&e.jsx(P,{onClick:z,color:"error",disabled:!r,children:e.jsx($o,{})}),e.jsx(P,{color:"inherit",onClick:()=>m(c=>!c),children:e.jsx(Fo,{badgeContent:R||0,color:"primary",children:e.jsx(So,{})})}),e.jsx(No,{isOpen:g,setIsOpen:m,postId:t}),e.jsx(P,{color:v?.isFavorite?"success":"inherit",onClick:()=>C("favorite"),disabled:!r,children:e.jsx(ko,{})}),e.jsx(P,{color:v?.like?"success":"inherit",onClick:()=>C("like"),disabled:!r,children:e.jsx(Mo,{})}),e.jsx(P,{color:v?.dislike?"error":"inherit",onClick:()=>C("dislike"),disabled:!r,children:e.jsx(Io,{})})]})},et=10,U=100,st=({title:t,body:o,author:s,postId:n,userId:a,viewType:i})=>{const l=Bo(),r=()=>{i||l(zo.post.replace(":id",String(n)))};return e.jsxs(x,{sx:{border:"1px solid #e0e0e0",p:3,borderRadius:1,mb:2,bgcolor:"background.paper"},children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(x,{direction:"row",alignItems:"center",spacing:2,children:s&&e.jsxs(e.Fragment,{children:[e.jsx(Ro,{sx:{width:35,height:35,color:"primary.main"}}),e.jsx(j,{variant:"h6",component:"h3",color:"primary",children:s})]})}),e.jsx(x,{children:e.jsx(wo,{postId:n,userId:a})})]}),e.jsx(x,{direction:"row",justifyContent:"space-between",spacing:4,children:e.jsxs(x,{spacing:1,flex:1,sx:[!i&&{cursor:"pointer"}],onClick:r,children:[e.jsx(j,{variant:"subtitle1",component:"p",sx:{fontWeight:500},children:t}),e.jsx(j,{variant:"body1",component:"p",sx:{color:"text.secondary"},children:!i&&o.length>U?`${o.slice(0,U)}…`:o})]})})]})};export{st as P,w as a,Jo as b,tt as c,ot as d,Go as e,Ko as f,et as g,Xo as s,Zo as u};
